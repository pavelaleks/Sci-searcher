<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ Sci-Searcher</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .check { margin: 10px 0; padding: 10px; background: white; border-radius: 5px; }
        .success { border-left: 4px solid green; }
        .error { border-left: 4px solid red; }
    </style>
</head>
<body>
    <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Sci-Searcher</h1>
    
    <div class="check">
        <h3>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ index.html</h3>
        <p id="loadStatus">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</p>
    </div>
    
    <div class="check">
        <h3>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ SciSearcher</h3>
        <p id="classStatus">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</p>
    </div>
    
    <div class="check">
        <h3>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—ã</h3>
        <p id="formStatus">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</p>
    </div>
    
    <div class="check">
        <h3>4. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞</h3>
        <button onclick="testSearch()">–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞</button>
        <p id="testStatus">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É</p>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ iframe
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = 'index.html';
        document.body.appendChild(iframe);
        
        iframe.onload = function() {
            document.getElementById('loadStatus').innerHTML = '‚úÖ index.html –∑–∞–≥—Ä—É–∂–µ–Ω';
            document.getElementById('loadStatus').parentElement.className = 'check success';
            
            setTimeout(() => {
                try {
                    const iframeWindow = iframe.contentWindow;
                    
                    if (iframeWindow.sciSearcher) {
                        document.getElementById('classStatus').innerHTML = '‚úÖ SciSearcher –Ω–∞–π–¥–µ–Ω';
                        document.getElementById('classStatus').parentElement.className = 'check success';
                        
                        if (iframeWindow.document.getElementById('openalexForm')) {
                            document.getElementById('formStatus').innerHTML = '‚úÖ –§–æ—Ä–º–∞ –Ω–∞–π–¥–µ–Ω–∞';
                            document.getElementById('formStatus').parentElement.className = 'check success';
                        } else {
                            document.getElementById('formStatus').innerHTML = '‚ùå –§–æ—Ä–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞';
                            document.getElementById('formStatus').parentElement.className = 'check error';
                        }
                    } else {
                        document.getElementById('classStatus').innerHTML = '‚ùå SciSearcher –Ω–µ –Ω–∞–π–¥–µ–Ω';
                        document.getElementById('classStatus').parentElement.className = 'check error';
                    }
                } catch (e) {
                    document.getElementById('classStatus').innerHTML = '‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: ' + e.message;
                    document.getElementById('classStatus').parentElement.className = 'check error';
                }
            }, 2000);
        };
        
        async function testSearch() {
            const testStatus = document.getElementById('testStatus');
            testStatus.innerHTML = 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º...';
            
            try {
                const iframeWindow = iframe.contentWindow;
                if (!iframeWindow.sciSearcher) {
                    throw new Error('SciSearcher –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                
                const results = await iframeWindow.sciSearcher.searchOpenAlex('–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ', 2020, 2023, 10);
                
                testStatus.innerHTML = `‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç! –ù–∞–π–¥–µ–Ω–æ ${results.length} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤`;
                testStatus.parentElement.className = 'check success';
            } catch (e) {
                testStatus.innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${e.message}`;
                testStatus.parentElement.className = 'check error';
            }
        }
    </script>
</body>
</html>

